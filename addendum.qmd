---
title: "Cool regressions for the 'Midlife Physical Activity and SuperAging: A Link to Better Cognitive Function, Functional Status, and Mental Health in Older Women'"
shorttitle: "Cool regressions"
author:
  - name: Josef Mana
    corresponding: false
    affiliations:
      - name: PVSPS
        department: OVV
abstract: "In this report, I present a set of analyses based propensity-scores matching followed by g-computation of the averagae treatment on controls (ATC) effect of midlife/lifelong physical activity on current cognitive superaging status (SA), current physical activity level (PA) mean cognitive performance (Cognitice CS), cognitive screening (MMSE), depressive symptoms (GDS-15), anxiety (GAI), and functional non-independence (FAQ) symptoms in elderly ladies."
keywords: [causal inference, propensity-scores matching, g-computation, old but gold, (g)old]
author-note:
  disclosures:
    Check the repository [https://github.com/josefmana/cosactiw-brief-report.git](https://github.com/josefmana/cosactiw-brief-report.git).
format:
  apaquarto-pdf: default
floatsintext: true
bibliography: references.bib
---

# Introduction

This report is a buffet of results inspired by Table 1 of the main article. In the table, we provide in-sample comparisons of 'distribution similarity' (via Mann-Whitney U test) and 'stochastical independence' (via Pearson's $\chi^2$ test) between NANOK and COSACTIW samples putatively representing the difference between samples with ***a lot of midlife physical activity (COSACTIW)*** and ***much less midlife physical activity (NANOK)***. In other words, we evaluated whether midlife physical activity relates to different distributions (e.g., higher/lower scores) in variables such as composite cognitive score (Cognition CS), cognitive screening (MMSE), functional independence difficulties (FAQ), depressive (GDS-15) or anxiety symptoms (GAI), and whether physically active women during midlife in our sample were more or less likely to achieve superager status (SA) or to be more physically active currently (PA) than women not as much physically active during midlife. Unfortunately, these samples differed substsantially in education distribution and to a lesser degree, age variance, possible ruining our fun from in-sample comparisons if causal inference with practical implications for larger population is of interest. Consequently, in this report I derive estimates that should be more robust than in-sample comparisons under the assumption that age and education are sufficient for explaining away confounding between midlife physical activity and the outcomes of interest described above.

::: callout-warning
The assumption, that age and education are sufficient to close all the back-doors [@pearl1995; @shpitser2012; @perkovic2018; @cinelli2024], is both critical to ensuring validity of presented results as correct estimates of causal effects, and possibly easily disputable. However, having some assumption about causal relations, reporting it, and logically deriving results based on this assumption is superior to stating no assumption about causal relations and still interpreting results as causal, even if the assumption is incorrect.
:::

::: {#tip-tips .callout-tip}
## Use of Tips in the text

Throughout the report, I use the green 'Tip' boxes such as this one to try re-phasing information from the main text to what I hope will be more accessible form of presentation. To start, the introduction section says:

  - I looked into COSACTW-vs-NANOK differences in the same variables as those reported in Table 1,
  - I adjusted/'controlled' for age and education level in some fancy statistical procedure,
  - if we believe age and education are 'good controls' then adjusting for them leads to valid results.
:::

::: callout-important
I also use this red box for sentences that could be used in a finished article's Methods or Results section (or used as inspiration for such sentences). For example, the preceding section could be summarised in the Methods (Statistical analyses) or Results (its own section such as 'Robustness checks' or 'Post-hoc comparisons') section as:

  - *"Since sampling procedures used for COSACTIW and NANOK resulted in samples with non-equivalent age and education level distributions, and both age and education can confound the effect of midlife physical activity on outcomes of interest, we further present comparisons adjusted for age, education-level, and their interaction with study group (COSACTIW vs NANOK)."*
:::

{{< pagebreak >}}

# Methods

To adjust our estimates for age and education, I opted for propensity scores matching (to 'balance' the samples in terms of age and education), followed by a set of weighted regressions (logistic or linear depending on the outcome) of outcome on group (COSACTIW vs NANOK), education level, age, and interaction of each education and age with group, and finished by estimating marginalised effects of several flavours (marginal effect of group, effect of group at each education level, and group/education interaction) via g-computation. I check neither effect of education because it would imply a different set of statistical models, nor effect of age from the same reason as well as because age ain't no variable that could be really intervened on.

::: callout-note
The type of effect I estimated in this report is the so-called *average treatment effect on controls (ATC)*. If valid (i.e., if its assumptions hold) it says what is the effect of expanding a treatment (midlife physical activity in our case) to those not receiving it. In other words, it tries to estimate how much controls (NANOK, not really physically active during midlife) would be better off in whatever variable we investigate (such as probability of SA nebo functional non-independence), if they were instead part of 'treatment' (COSACTIW, really a lot physically active during midlife).

There are other estimands one could use instead, principally:

  - *average treatment effect on treated (ATT)* says what if instead being physically active during midlife the COSACTIW women were not physically active during midlife, how much would it hurt?
  - vanilla *average treatment effect (ATE)* says what difference would be between a sample where all participants would be physically active during midlife, and the same sample if all the participants were not physically active during midlife?
  
I did not use ATT or ATE because (i) ATC seemed to be of most practical interest, (ii) ATT ended up having way to low 'effective sample size.'
:::

::: {#tip-methods .callout-tip}
## Methods used

In this bunch of the text I simply list procedures used. The main takeaways for you should be that in the report I present numbers reflecting:

  - means scores/proportions (e.g., percent of SA) in COSACTIW and NANOK that are not skewed by education or age,
  - the difference between COSACTIW and NANOK that are not skewed by education or age,
  - means scores/proportions in COSACTIW and NANOK separately for low and high education levels,
  - differences between COSACTIW and NANOK depending on education (do COSACTIW high education differ from COSACTIW low education more than NANOK high education differ from NANOK low education?)
:::

::: callout-important
In a full-blown article, this would go somewhere to Methods (it is quite a mouthful, it could be shortened for sure):

  - *"To adjust for confounding due to age and education, we used propensity scores matching to estimate marginal effect of midlife physical activity (operationalised as group membership to either COSACTIW or NANOK samples) on a set of cognitive function, and mental health outcomes. We used full matching on propensity scores estimated by a logit regression of the group membership on age and education level, which yielded good balance, as indicated by @fig-bal. Next, we estimated a set of logistic and linear regressions for nominal and continuous variables respectively, regressing each outcome on group membership, age, education level as well as group memebership interaction with both age and educaton. In all regressions, the full matching weights were included in the estimation as implemented in the glm() function of base R [@rsoft]. Finally, we estimated group-specific average values of each outcome of interest adjusted for age and education level, and compared these quantities via g-computation with a cluster-robust variance estimate of its standard error as implemented in the 'marginaleffects' R package [@arel-bundock]. Both, the matching and g-computation analyses were used to estimate the Average Treatment Effect on the Control (ATC) with COSACTIW representing treatment group and NANOK representing the control group."*
:::

![Disgtributional balance of age (top row) and education level (bottom row) in original sample (left column) and propensity scores weighted (right column) sample.](figures/propensity_scores_check.jpg){#fig-bal}

{{< pagebreak >}}

# Results

::: callout-warning
In this section I present only the results as they relate to specified research questions. I do not show any model diagnostics or further technical discussion underlying reliability of the results (depending on whether statistical models 'behave well'). Although this is a very nerdy stuff, one point that could arise during review should be discussed nonetheless - I used classical Gaussian (normal) linear regression for outcome variables that are clearly not Gaussian (at least in the sample, maybe even never) such as MMSE, FAQ, GDS-15, and GAI. There are four main reasons why I do not consider the non-normality to matter much are:

  1. for parameter estimates bias (i.e., 'validity'), the more important factor seems to be correct causal specification even when the data-generating process is very skewed and quite exotic, and classical linear regression still achieves correct frequentist properties (Type I and II errors, let us call them 'reliability' here) in such cases [@scholz2024]; on the other hand, sure, we could do better if we wanted to dive deep into it, see [https://users.aalto.fi/~ave/casestudies/Nabiximols/nabiximols.html](https://users.aalto.fi/~ave/casestudies/Nabiximols/nabiximols.html) if you are a masochist),
  2. least squares linear regression is a maximum entropy solution for finding a mean of a distribution with homoscedasticity, and I tried posterior predictive checks on FAQ model - sample mean and SD were well reproduced by the model, distribution shape was not - the results will most likely still be valid for inference, not so for prediction though [cf. @zhang2023],
  3. the continuous variables are sums of answers, they should converge to normal distribution in theory if well constructed,
  4. the g-computation estimates of standard errors ought to be 'robust' to non-normality and (more importantly) heteroscedasticity from what I understood.
:::


```{r}
#| label: tbl-marginaleffects

read.csv( here("tables","gcomputation_results.csv"), sep = ";" ) %>%
    filter( is.na(Education) ) %>%
    filter( term != "higher - lower")
    View()
```

{{< pagebreak >}}

# Appendix


{{< pagebreak >}}

# References
